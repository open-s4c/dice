/*
 * Copyright (C) Huawei Technologies Co., Ltd. 2025. All rights reserved.
 * SPDX-License-Identifier: 0BSD
 */
#include <dice/pubsub.h>
#define $_mute
#define $_begin(...)
#define $_map(...)
#define $_end()
#define $2_begin(...)
#define $2_end()
#define CCC 0
#define EEE 0
#define SSS 0
#define $_unmute

/* chain dispatcher prototypes */
$_begin(CCC = CHAINS);
DICE_WEAK DICE_HIDE enum ps_err
ps_dispatch_CCC_(const chain_id chain, const type_id type, void *event,
                 metadata_t *md)
{
    (void)chain;
    (void)type;
    (void)event;
    (void)md;
    return PS_HANDLER_OFF;
}

DICE_WEAK DICE_HIDE bool
ps_dispatch_chain_CCC_on_(void)
{
    return false;
}
$_end();

DICE_HIDE bool
ps_dispatch_chain_on_(const chain_id chain)
{
    switch (chain) {
        default:
            return false;
            $_begin(CCC = CHAINS);
        case CCC:
            return ps_dispatch_chain_CCC_on_();
            $_end();
    }
}

/* main dispatcher */
DICE_HIDE enum ps_err
ps_dispatch_(const chain_id chain, const type_id type, void *event,
             metadata_t *md)
{
    $_begin(CCC = CHAINS);
    if (likely(chain == CCC))
        return ps_dispatch_CCC_(chain, type, event, md);
    $_end();
    return PS_HANDLER_OFF;
}

$_begin(SSS = SLOTS);
DICE_WEAK DICE_HIDE bool
ps_dispatch_slot_SSS_on_(void)
{
    return false;
}
$_end();

DICE_HIDE int
ps_dispatch_max(void)
{
    int max = -1;
    $_begin(SSS = SLOTS);
    if (ps_dispatch_slot_SSS_on_())
        max = max < SSS ? SSS : max;
    $_end();

    return max;
}
