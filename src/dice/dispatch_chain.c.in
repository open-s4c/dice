/*
 * Copyright (C) Huawei Technologies Co., Ltd. 2025. All rights reserved.
 * SPDX-License-Identifier: 0BSD
 */
#include <dice/pubsub.h>
#define $_mute
#define $_begin(...)
#define $_map(...)
#define $_end()
#define $2_begin(...)
#define $2_end()
#define CCC 0
#define EEE 0
#define SSS 0
#define $_unmute
$_begin(CCC = CHAINS, SSS = SLOTS);
DICE_WEAK DICE_HIDE enum ps_err
ps_dispatch_CCC_0_SSS_(const chain_id chain, const type_id type, void *event,
                       metadata_t *md)
{
    (void)chain;
    (void)type;
    (void)event;
    (void)md;
    return PS_HANDLER_OFF;
}
$_end();

$_begin(CCC = CHAINS, EEE = EVENTS, SSS = SLOTS);
DICE_WEAK DICE_HIDE enum ps_err
ps_dispatch_CCC_EEE_SSS_(const chain_id chain, const type_id type, void *event,
                         metadata_t *md)
{
    (void)chain;
    (void)type;
    (void)event;
    (void)md;
    return PS_HANDLER_OFF;
}
$_end();

$_begin(CCC = CHAINS, EEE = EVENTS);
static enum ps_err
ps_dispatch_CCC_EEE_(const chain_id chain, const type_id type, void *event,
                     metadata_t *md)
{
    enum ps_err err;
    $2_begin(SSS = SLOTS);
    {
        err = ps_dispatch_CCC_EEE_SSS_(chain, type, event, md);
        if (err == PS_HANDLER_OFF)
            err = ps_dispatch_CCC_0_SSS_(chain, type, event, md);
        if (err == PS_STOP_CHAIN)
            return PS_STOP_CHAIN;
    }
    $2_end();
    return PS_OK;
}
$_end();

/* chain dispatcher prototypes */
$_begin(CCC = CHAINS);
DICE_HIDE enum ps_err
ps_dispatch_CCC_(const chain_id chain, const type_id type, void *event,
                 metadata_t *md)
{
    switch (type) {
        default:
            return PS_HANDLER_OFF;
            $2_begin(EEE = EVENTS);
        case EEE:
            return ps_dispatch_CCC_EEE_(chain, type, event, md);
            $2_end();
    }
}
DICE_HIDE bool
ps_dispatch_chain_CCC_on_(void)
{
    return true;
}
$_end();
